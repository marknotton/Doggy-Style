$devices : mobile tablet desktop;

@mixin devices($args...) {

  // This checks to see if the current selector is html. 
  // This can not be converted into a shorthanded if statement. 
  $selector : null;
  @if not is-selector(html) and not is-selector(body) { $selector : &; }
  
  $selector : str-replace(#{&}, 'body', '');

  @each $settings in _arglist-to-list($args...) {
    
    $devices-list : ();
    $types-list : ();
    $no-space : false;

    @each $setting in $settings {
      @if is-string($setting) {
        @if contains($devices, $setting) and length($devices-list) < 2 {
          $devices-list : append($devices-list, $setting);
        } @else {
          $types-list : append($types-list, $setting);
        }
      } @elseif is-bool($setting) {
        $no-space : $setting;
      }
    }

    @if length($devices-list) > 1 and length($types-list) > 0 { 
      @error 'You can not check the same version for 2 browsers in a single argument. Try seperating the arguments using a comma (,)';
    } @else {
      @if length($devices-list) > 0 {
        @if length($types-list) > 0 {
          @each $type in $types-list {
            @at-root #{if(not $no-body, body, null)}#{$devices-list}.#{$type} #{$selector} { @content }
          }
        } @else {
          @each $device in $devices-list {
            @at-root body.#{$device}#{if($no-space, '', ' ')}#{$selector}{ @content }
          }
        }
      }
    }
  }
}

// Usage : @include mobile { ... }
// Usage : @include mobile(samgsung) { ... }
@mixin mobile($type:null) { 
  @include devices(mobile $type) { @content };
}

@mixin tablet($type:null) { 
  @include devices(tablet $type) { @content };
}

@mixin desktop($type:null) { 
  @include devices(desktop $type) { @content };
}


/// Add specical styling for specific classes that sit on the body of the page. 
/// for example, iphone devices specifcally. 
/// @todo Add checks and validation
@mixin identify($class) {
  
  $selector : null;
  @if not is-selector(html) and not is-selector(body){ $selector : &; }

  @at-root body.#{$class} #{$selector} { @content }
}